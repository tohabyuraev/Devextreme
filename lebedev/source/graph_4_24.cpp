#include "../core/interp.hpp"
#include "graph.hpp"


float graph_4_24a_1(
    const float M,
    const float lambda_k)
{
    map_t data_1 = {{0.6, 0.0706406210408848}, {0.65, 0.0721035930308065}, {0.7, 0.0748477639156771}, {0.8,0.0839340590220422}, {0.9,0.0992269942343103}, {0.95,0.111191406176804}, {1.0,0.127266512472227}, {1.025,0.139099189424786}, {1.05,0.142067267616885}, {1.075,0.143676132431294}, {1.1,0.144577651508333}, {1.125,0.14507695438177}, {1.15,0.145035345808984}, {1.175,0.144563781984071}, {1.2,0.143800958149653}, {1.25,0.141332182830991}, {1.3,0.137559672231688}, {1.35,0.13356524924419}, {1.4,0.129667912926527}, {1.5,0.122594455552834}, {1.6,0.116644429644374}, {1.7,0.111387879949021}, {1.8,0.106949632185134}, {1.9,0.103091228422019}, {2.0,0.0999732614812755}, {2.125,0.0953269708534569}, {2.25,0.0913048088174349}, {2.5,0.0846454826248894}, {2.75,0.0793309483665476}, {3.0,0.0749450714034379}, {3.25,0.0709621639719695}, {3.5,0.067824666620509}, {3.75,0.0650127586168416}, {4.0,0.0624376428661145}, {4.25,0.0604841067793561}, {4.5,0.0588265610087732}, {5.0,0.0564586384793691}, {5.5,0.0555706675308425}};
    map_t data_2 = {{0.6, 0.0634166904152620}, {0.65, 0.0645677238741557}, {0.7, 0.0667375601609539}, {0.8,0.0739970367322528}, {0.9,0.085109566840704}, {0.95,0.0927802467547587}, {1.0,0.102177526740023}, {1.025,0.105900247389932}, {1.05,0.107353633400336}, {1.075,0.108166352124117}, {1.1,0.108452099765547}, {1.125,0.108383063414879}, {1.15,0.108036014021149}, {1.175,0.107540297284138}, {1.2,0.106538105341315}, {1.25,0.104574180627756}, {1.3,0.102061022731592}, {1.35,0.0995478648354273}, {1.4,0.0973176452454534}, {1.5,0.093006996933489}, {1.6,0.0891790080850264}, {1.7,0.0858836089893934}, {1.8,0.0830875127870381}, {1.9,0.0805540170843445}, {2.0,0.0784078532675452}, {2.125,0.0758209951910662}, {2.25,0.0731480167216725}, {2.5,0.0690565072269217}, {2.75,0.065808727091258}, {3.0,0.0632890969504227}, {3.25,0.0613318658162603}, {3.5,0.0596189592342722}, {3.75,0.0578584719138956}, {4.0,0.056526211239016}, {4.25,0.0554794349944678}, {4.5,0.0546705624418623}, {5.0,0.0537924127687795}, {5.5,0.0534593476000596}};

    if (lambda_k < 2.0) {
        return interp1d(M, data_1);
    }
    else if (lambda_k < 3.0) {
        map_t points = {
            {2.0, interp1d(M, data_1)},
            {3.0, interp1d(M, data_2)},
        };
        return interp1d(lambda_k, points);
    }
    else {
        return interp1d(M, data_2);
    }
}


float graph_4_24a_2(
    const float M,
    const float lambda_k)
{
    map_t data_1 = {{0.6, 0.0622441418018386}, {0.65, 0.0632505087661088}, {0.7, 0.0652632426946492}, {0.8,0.0715522159926454}, {0.9,0.0819270078388895}, {0.95,0.0889386477378263}, {1.0,0.0983021422165695}, {1.025,0.101970320312058}, {1.05,0.104460874389152}, {1.075,0.106777957037992}, {1.1,0.10821529172925}, {1.125,0.108772878462928}, {1.15,0.109033085605311}, {1.175,0.109132212135743}, {1.2,0.109057867237919}, {1.25,0.108791274585731}, {1.3,0.107970506848529}, {1.35,0.106382499704811}, {1.4,0.104282622669696}, {1.5,0.0999567278476967}, {1.6,0.0958245051933834}, {1.7,0.0917485662767162}, {1.8,0.0876976331202739}, {1.9,0.0837728978884524}, {2.0,0.0798481635130918}, {2.125,0.0758209951910662}, {2.25,0.0717106159205762}, {2.5,0.0642679514109501}, {2.75,0.0583504744753965}, {3.0,0.0528357246828332}, {3.25,0.0480034463783211}, {3.5,0.0435862477201336}, {3.75,0.039905196749687}, {4.0,0.0364290976128677}, {4.25,0.033476214797458}, {4.5,0.03}, {5.0,0.0264102499187623}, {5.5,0.0231975453077897}};
    map_t data_2 = {{0.6, 0.0600000000000000}, {0.7, 0.06051400130537240}, {0.8, 0.0617895161045020}, {0.9,0.0642440270573766}, {0.95,0.0658759116110999}, {1.0,0.0679659388800653}, {1.025,0.0690903126393121}, {1.05,0.070521895355311}, {1.075,0.0719329725941229}, {1.1,0.0733599338429067}, {1.125,0.0745318512803327}, {1.15,0.0754969394839803}, {1.175,0.0760525743756217}, {1.2,0.0763178627951995}, {1.25,0.0764424595802041}, {1.3,0.0760325418675302}, {1.35,0.0752474201593197}, {1.4,0.0739839918408706}, {1.5,0.0706225517075827}, {1.6,0.0670990725256003}, {1.7,0.063467457630903}, {1.8,0.0600391128887553}, {1.9,0.05649254930713}, {2.0,0.0529263249273739}, {2.125,0.05}, {2.25,0.0485597584996077}, {2.5,0.0446858354247112}, {2.75,0.0415036787617081}, {3.0,0.0385644250783998}, {3.25,0.0358574648155524}, {3.5,0.0334232405718572}, {3.75,0.0309696397647235}, {4.0,0.0287921735941739}, {4.25,0.0267403063224817}, {4.5,0.0247612448857368}, {5.0,0.0211604152702595}, {5.5,0.0178896617028676}};
    map_t data_3 = {{0.6, 0.0527434357809699}, {0.7, 0.05279243799937260}, {0.8, 0.0530936753435344}, {0.9,0.0533790594915826}, {0.95,0.0535554655820581}, {1.0,0.0537964293849021}, {1.025,0.0538959018251675}, {1.05,0.0539953742654329}, {1.075,0.0541338860787151}, {1.1,0.0542907882957206}, {1.125,0.0544072915667706}, {1.15,0.0545471853786118}, {1.175,0.0545677614339974}, {1.2,0.0545438408530201}, {1.25,0.0543592349386673}, {1.3,0.0539819967658593}, {1.35,0.0534442317110054}, {1.4,0.0527619924623102}, {1.5,0.0509159333187819}, {1.6,0.0488258730477838}, {1.7,0.046273495521831}, {1.8,0.0438655921954605}, {1.9,0.0419862683562913}, {2.0,0.04}, {2.125,0.0382727499635283}, {2.25,0.0366202815069078}, {2.5,0.0333936549421391}, {2.75,0.0308036068490839}, {3.0,0.0285960409917466}, {3.25,0.0265502862443712}, {3.5,0.0247588060983645}, {3.75,0.0230019997616354}, {4.0,0.0216034894541076}, {4.25,0.02}, {4.5,0.0188642585211812}, {5.0,0.0168069458373799}, {5.5,0.0150732553735025}};

    if (lambda_k < 1.5) {
        return interp1d(M, data_1);
    }
    else if (lambda_k < 2.0) {
        map_t points = {
            {1.5, interp1d(M, data_1)},
            {2.0, interp1d(M, data_2)},
        };
        return interp1d(lambda_k, points);
    }
    else if (lambda_k < 2.5) {
        map_t points = {
            {2.0, interp1d(M, data_2)},
            {2.5, interp1d(M, data_3)},
        };
        return interp1d(lambda_k, points);
    }
    else {
        return interp1d(M, data_3);
    }
}


float graph_4_24a_3(
    const float M,
    const float lambda_k)
{
    map_t data_1 = {{0.6, 0.0500000000000000}, {0.7, 0.0500000000000000}, {0.8, 0.0509589101219369}, {0.9,0.0519575158688114}, {0.95,0.0533790594915826}, {1.0,0.0544574563100137}, {1.025,0.0555358531284448}, {1.05,0.056028391249616}, {1.075,0.0565168435373037}, {1.1,0.0569715954632228}, {1.125,0.0574131185931121}, {1.15,0.0578008487088997}, {1.175,0.0581889984921701}, {1.2,0.0584966750038655}, {1.25,0.0588043515155609}, {1.3,0.0593126866218403}, {1.35,0.0594999679767853}, {1.4,0.0595200338362437}, {1.5,0.0591722256056315}, {1.6,0.0579020401451876}, {1.7,0.0552930928723058}, {1.8,0.0521397024605662}, {1.9,0.048360909345602}, {2.0,0.0442497075486642}, {2.125,0.04}, {2.25,0.0373672708326386}, {2.5,0.0345960359135507}, {2.75,0.0301464835021188}, {3.0,0.0271977340284701}, {3.25,0.024611662378485}, {3.5,0.0223614404325713}, {3.75,0.02}, {4.0,0.0185221724445914}, {4.25,0.0170533514738711}, {4.5,0.0157370310410944}, {5.0,0.0146213692108751}, {5.5,0.0129197842611882}};
    map_t data_2 = {{0.6, 0.0432873985759425}, {0.7, 0.0420738527325041}, {0.8, 0.0401475300714077}, {0.9,0.0371039402668754}, {0.95,0.0360768835044681}, {1.0,0.0351198279259461}, {1.025,0.0347147518296253}, {1.05,0.0343096757333044}, {1.075,0.0340890245973152}, {1.1,0.0338990082194077}, {1.125,0.0338621181776716}, {1.15,0.0338243413986992}, {1.175,0.0338380888021434}, {1.2,0.033884074855266}, {1.25,0.0341006086353207}, {1.3,0.0341006086353207}, {1.35,0.0340483418608247}, {1.4,0.0336824744393531}, {1.5,0.0329731396426225}, {1.6,0.0318158039216409}, {1.7,0.03}, {1.8,0.0290021449150624}, {1.9,0.0272890296304501}, {2.0,0.0255055868846465}, {2.125,0.0240846076990655}, {2.25,0.0226925541586695}, {2.5,0.02}, {2.75,0.0181560602385742}, {3.0,0.0166232517126718}, {3.25,0.0149510969571418}, {3.5,0.0136969808904943}, {3.75,0.0125357623102651}, {4.0,0.0116067874460818}, {4.25,0.0106468467530924}, {4.5,0.01}, {5.0,0.00916048697039905}, {5.5,0.00843278999345545}};
    map_t data_3 = {{0.6, 0.0390347907656099}, {0.7, 0.0363967348383171}, {0.8, 0.0334009173596076}, {0.9,0.030045601783453}, {0.95,0.0285614732932753}, {1.0,0.0270773448030976}, {1.025,0.0264433194330986}, {1.05,0.0258092940630996}, {1.075,0.0253282027561801}, {1.1,0.0248471114492607}, {1.125,0.0244193940140394}, {1.15,0.0240556248020748}, {1.175,0.0236330122010909}, {1.2,0.0233031551022854}, {1.25,0.0228070824853872}, {1.3,0.0223221575677452}, {1.35,0.0220824820337382}, {1.4,0.0217926418530785}, {1.5,0.0215544788275461}, {1.6,0.0213457938808864}, {1.7,0.0204268312441714}, {1.8,0.0198046900190246}, {1.9,0.0189744749822574}, {2.0,0.0181442599454903}, {2.125,0.0169270707819387}, {2.25,0.0157309627238771}, {2.5,0.0136782731330796}, {2.75,0.0120694083186708}, {3.0,0.0107101949409806}, {3.25,0.00978093681541691}, {3.5,0.00887941773837749}, {3.75,0.00819981104953238}, {4.0,0.00768663865183302}, {4.25,0.00722894435118224}, {4.5,0.00689607576889076}, {5.0,0.00661868528364786}, {5.5,0.00663255480791001}};

    if (lambda_k < 1.0) {
        return interp1d(M, data_1);
    }
    else if (lambda_k < 1.5) {
        map_t points = {
            {1.0, interp1d(M, data_1)},
            {1.5, interp1d(M, data_2)},
        };
        return interp1d(lambda_k, points);
    }
    else if (lambda_k < 2.0) {
        map_t points = {
            {1.5, interp1d(M, data_2)},
            {2.0, interp1d(M, data_3)},
        };
        return interp1d(lambda_k, points);
    }
    else {
        return interp1d(M, data_3);
    }
}


float graph_4_24a(
    const float M,
    const float eta_korm,
    const float lambda_k)
{
    if (eta_korm < 0.0) {
        return graph_4_24a_1(M, lambda_k);
    }
    else if (eta_korm < 0.5) {
        map_t points = {
            {0.0, graph_4_24a_1(M, lambda_k)},
            {0.5, graph_4_24a_2(M, lambda_k)},
        };
        return interp1d(eta_korm, points);
    }
    else if (eta_korm < 0.75) {
        map_t points = {
            {0.50, graph_4_24a_2(M, lambda_k)},
            {0.75, graph_4_24a_3(M, lambda_k)},
        };
        return interp1d(eta_korm, points);
    }
    else {
        return graph_4_24a_3(M, lambda_k);
    }
}


float graph_4_24b_1(
    const float M,
    const float lambda_k)
{
    map_t data_1 = {{0.6, 0.0590761037735384}, {0.65, 0.0620480978883868}, {0.7, 0.0668650209618531}, {0.8,0.0785010842010934}, {0.85,0.0880038691798063}, {0.9,0.0999502274387596}, {0.95,0.116667371625802}, {1.0,0.138659531147966}, {1.025,0.153717101082117}, {1.05,0.161804664395692}, {1.1,0.166153428893437}, {1.15,0.167571898040479}, {1.2,0.167587485613523}, {1.25,0.166901632399569}, {1.3,0.165077886353373}, {1.35,0.162661812531488}, {1.4,0.15955988549565}, {1.5,0.153091042682218}, {1.6,0.146715725307053}, {1.8,0.134557418332411}, {2.0,0.124098156819609}, {2.125,0.117383866484322}, {2.25,0.111392266563167}, {2.375,0.105671558374286}, {2.5,0.099921831027724}, {2.625,0.0948140449267133}, {2.75,0.0898272938555849}, {2.875,0.0851618343972366}, {3.0,0.0807179410370065}, {3.5,0.0687190217853424}, {4.0,0.0602926089214686}, {4.5,0.0548490776820024}, {4.75,0.0526042087108346}, {5.0,0.0505084932841143}, {5.25,0.0487767705367717}, {5.5,0.0475744916867058}};
    map_t data_2 = {{0.6, 0.0556912640227290}, {0.65, 0.0573748962872895}, {0.7, 0.0600000000000000}, {0.8,0.0670039246964333}, {0.85,0.0725894714820651}, {0.9,0.079032334751073}, {0.95,0.0883718885623969}, {1.0,0.1}, {1.025,0.10545970302419}, {1.05,0.110700962442968}, {1.1,0.120015509087951}, {1.15,0.124088131059853}, {1.2,0.125574961303564}, {1.25,0.125690351522823}, {1.3,0.124403416171091}, {1.35,0.121950384467789}, {1.4,0.118827039872671}, {1.5,0.113215513799664}, {1.6,0.10800666668097}, {1.8,0.0992906157666473}, {2.0,0.0922370130596655}, {2.125,0.0890465754786965}, {2.25,0.086018846378323}, {2.375,0.0831095200919306}, {2.5,0.0803524259949424}, {2.625,0.0777212719075306}, {2.75,0.0750277003349232}, {2.875,0.0726798837974113}, {3.0,0.07}, {3.5,0.063089784779771}, {4.0,0.0572163818757833}, {4.5,0.0525722958586767}, {4.75,0.0506600251457505}, {5.0,0.0489526405806378}, {5.25,0.0476282293360527}, {5.5,0.0469420699088544}};

    if (lambda_k < 2.0) {
        return interp1d(M, data_1);
    }
    else if (lambda_k < 3.0) {
        map_t points = {
            {2.0, interp1d(M, data_1)},
            {3.0, interp1d(M, data_2)},
        };
        return interp1d(lambda_k, points);
    }
    else {
        return interp1d(M, data_2);
    }
}


float graph_4_24b_2(
    const float M,
    const float lambda_k)
{
    map_t data_1 = {{0.6, 0.0542520745335896}, {0.65, 0.0560360343222467}, {0.7, 0.0585885473914241}, {0.75,0.0632211775612687}, {0.8,0.0693475272098925}, {0.85,0.0779656896155023}, {0.9,0.0894570868576961}, {0.95,0.10001246528267}, {1.0,0.112206264623027}, {1.025,0.119422070974249}, {1.05,0.124628412265637}, {1.1,0.130748146766041}, {1.15,0.134995425187963}, {1.2,0.13768885665608}, {1.25,0.138719595397547}, {1.3,0.139221750169031}, {1.35,0.139116033375034}, {1.4,0.137926719442572}, {1.5,0.133659806876233}, {1.6,0.128143747758431}, {1.8,0.116833216444327}, {2.0,0.105731494939098}, {2.125,0.0999624943875459}, {2.25,0.0942216495286345}, {2.375,0.0889662556989382}, {2.5,0.0837890641897361}, {2.625,0.0790493773708077}, {2.75,0.0743625615712355}, {2.875,0.069858612824662}, {3.0,0.0656922140871692}, {3.5,0.052397989588745}, {4.0,0.0429667465545227}, {4.5,0.0356236016090581}, {4.75,0.0328046691892352}, {5.0,0.0304207572045701}, {5.25,0.0288546836380018}, {5.5,0.0280194444024987}};
    map_t data_2 = {{0.6, 0.0500000000000000}, {0.7, 0.0517896161985129}, {0.8, 0.0552262774996994}, {0.85,0.0579524054516954}, {0.9,0.0620996001020723}, {0.95,0.0690599267880195}, {1.0,0.0784708684946439}, {1.025,0.0826875944738796}, {1.05,0.086667056311093}, {1.1,0.0929715490903673}, {1.15,0.0979044287141645}, {1.2,0.100990425459802}, {1.25,0.103223530271544}, {1.3,0.103890561578947}, {1.35,0.104035568384904}, {1.4,0.103673051370011}, {1.5,0.101193434988142}, {1.6,0.0970317396571698}, {1.8,0.0883023299385444}, {2.0,0.0795584195393232}, {2.125,0.0755951272429948}, {2.25,0.0718212035936461}, {2.375,0.0680458769336382}, {2.5,0.0644487103585794}, {2.625,0.0611068783925555}, {2.75,0.0577812723397872}, {2.875,0.0545805221391837}, {3.0,0.0514561005448113}, {3.5,0.0415521356979322}, {4.0,0.0341857899553048}, {4.5,0.0287190333707171}, {4.75,0.0265721904698518}, {5.0,0.0249923584576162}, {5.25,0.0235814253346685}, {5.5,0.0230083949417382}};
    map_t data_3 = {{0.6, 0.0462290648992918}, {0.7, 0.0464137805597008}, {0.8, 0.0476211371480077}, {0.85,0.0487696081019907}, {0.9,0.05}, {0.95,0.0531500759631105}, {1.0,0.0569936943235365}, {1.025,0.0595306150957612}, {1.05,0.0622591809024879}, {1.1,0.0675246674814394}, {1.15,0.0720408245766809}, {1.2,0.0754798088217298}, {1.25,0.0779361794620276}, {1.3,0.0793512358996781}, {1.35,0.0796478350606103}, {1.4,0.0791732546600138}, {1.5,0.0768531122394901}, {1.6,0.0735481019283048}, {1.8,0.0671810230064489}, {2.0,0.06}, {2.125,0.0576863856208335}, {2.25,0.054971256481424}, {2.375,0.0521774432001309}, {2.5,0.0496729029163968}, {2.625,0.0471391341837468}, {2.75,0.0448108740957374}, {2.875,0.0425991325548139}, {3.0,0.04}, {3.5,0.0334044746583546}, {4.0,0.0281370648288519}, {4.5,0.0244074667994043}, {4.75,0.0229643046428913}, {5.0,0.0217423576832675}, {5.25,0.0204107401072704}, {5.5,0.02}};

    if (lambda_k < 1.5) {
        return interp1d(M, data_1);
    }
    else if (lambda_k < 2.0) {
        map_t points = {
            {1.5, interp1d(M, data_1)},
            {2.0, interp1d(M, data_2)},
        };
        return interp1d(lambda_k, points);
    }
    else if (lambda_k < 2.5) {
        map_t points = {
            {2.0, interp1d(M, data_2)},
            {2.5, interp1d(M, data_3)},
        };
        return interp1d(lambda_k, points);
    }
    else {
        return interp1d(M, data_3);
    }
}


float graph_4_24b_3(
    const float M,
    const float lambda_k)
{
    map_t data_1 = {{0.6, 0.0414127380555039}, {0.65, 0.0416639257517001}, {0.7, 0.0424470433623302}, {0.75,0.0432635890672929}, {0.8,0.0448220453982348}, {0.85,0.0464661933673078}, {0.9,0.049239214330301}, {0.95,0.0534805628949964}, {1.0,0.0592073607265897}, {1.025,0.0627537743478859}, {1.05,0.0661920838399821}, {1.1,0.0711467008175769}, {1.15,0.0751608612214383}, {1.2,0.0788953834848059}, {1.25,0.0821518147337811}, {1.3,0.0845963933168068}, {1.35,0.0862200986487058}, {1.4,0.0869237042925286}, {1.5,0.0858476639588902}, {1.6,0.082366439450636}, {1.8,0.0741180157090634}, {2.0,0.0658566023238033}, {2.125,0.0621078599221995}, {2.25,0.0584702470195004}, {2.375,0.0549864635181593}, {2.5,0.0515809839112233}, {2.625,0.0486408008616754}, {2.75,0.0457717230588607}, {2.875,0.0430684093814724}, {3.0,0.0403650957040841}, {3.5,0.0320556311629848}, {4.0,0.0254049335949767}, {4.5,0.0202610346947204}, {4.75,0.0181567124173428}, {5.0,0.0165719758874659}, {5.25,0.0152600218750268}, {5.5,0.0146495086217135}};
    map_t data_2 = {{0.6, 0.0352613438253407}, {0.7, 0.0352094397572144}, {0.8, 0.0355101259178401}, {0.85,0.0362017040872792}, {0.9,0.0372240370334066}, {0.95,0.0385470561401596}, {1.0,0.0405616534163517}, {1.025,0.0418771553690891}, {1.05,0.0431926573218265}, {1.1,0.0458236612273013}, {1.15,0.0480487388159314}, {1.2,0.049612306851185}, {1.25,0.0507549142615626}, {1.3,0.0516269041273771}, {1.35,0.0518674530558777}, {1.4,0.0516391062130068}, {1.5,0.0502036944148101}, {1.6,0.0475518097367114}, {1.8,0.0425612551062737}, {2.0,0.037173961823207}, {2.125,0.0351824125289249}, {2.25,0.0332055686263362}, {2.375,0.0312863912431055}, {2.5,0.0294688795695186}, {2.625,0.0276391726852205}, {2.75,0.0259152294603961}, {2.875,0.024332854836362}, {3.0,0.0228287273834132}, {3.5,0.0180261015884313}, {4.0,0.0144972156782054}, {4.5,0.0124717604516261}, {4.75,0.0111144966400008}, {5.0,0.01}, {5.25,0.00969458988322353}, {5.5,0.00940225613918116}};
    map_t data_3 = {{0.6, 0.0300000000000000}, {0.7, 0.0300000000000000}, {0.8, 0.0304226050475326}, {0.85,0.0305628932049323}, {0.9,0.0309694890225373}, {0.95,0.0313734470032418}, {1.0,0.0318254866215298}, {1.025,0.0321612834740701}, {1.05,0.0325347211950506}, {1.1,0.0332439557685714}, {1.15,0.0337271705329483}, {1.2,0.0340077468477477}, {1.25,0.0339921592747033}, {1.3,0.0339609841286145}, {1.35,0.0335401196564153}, {1.4,0.0331036676111717}, {1.45,0.0325752762485051}, {1.5,0.0320125374980628}, {1.55,0.0312596720179573}, {1.6,0.0305473056318879}, {1.7,0.0289116950852258}, {1.8,0.0272427401464722}, {1.9,0.0252855441995844}, {2.0,0.0231432084357915}, {2.125,0.0218505740099133}, {2.25,0.0206715561200867}, {2.375,0.0195020523986588}, {2.5,0.0183422359381121}, {2.625,0.0173532949213282}, {2.75,0.0164438068714929}, {2.875,0.0155746560237645}, {3.0,0.0148038568570302}, {3.5,0.0122786700238352}, {4.0,0.0105172742698165}, {4.5,0.00917674298799693}, {4.75,0.00852206492013156}, {5.0,0.00805443772879915}, {5.25,0.00778944898704412}, {5.5,0.00755563539137792}};

    if (lambda_k < 1.0) {
        return interp1d(M, data_1);
    }
    else if (lambda_k < 1.5) {
        map_t points = {
            {1.0, interp1d(M, data_1)},
            {1.5, interp1d(M, data_2)},
        };
        return interp1d(lambda_k, points);
    }
    else if (lambda_k < 2.0) {
        map_t points = {
            {1.5, interp1d(M, data_2)},
            {2.0, interp1d(M, data_3)},
        };
        return interp1d(lambda_k, points);
    }
    else {
        return interp1d(M, data_3);
    }
}


float graph_4_24b(
    const float M,
    const float eta_korm,
    const float lambda_k)
{
    if (eta_korm < 0.0) {
        return graph_4_24b_1(M, lambda_k);
    }
    else if (eta_korm < 0.5) {
        map_t points = {
            {0.0, graph_4_24b_1(M, lambda_k)},
            {0.5, graph_4_24b_2(M, lambda_k)},
        };
        return interp1d(eta_korm, points);
    }
    else if (eta_korm < 0.75) {
        map_t points = {
            {0.50, graph_4_24b_2(M, lambda_k)},
            {0.75, graph_4_24b_3(M, lambda_k)},
        };
        return interp1d(eta_korm, points);
    }
    else {
        return graph_4_24b_3(M, lambda_k);
    }
}


float graph_4_24(
    const float M,
    const float eta_korm,
    const float lambda_k,
    const float korm_type)
{
    if (korm_type == 0.0) {
        return graph_4_24a(M, eta_korm, lambda_k);
    }
    else {
        return graph_4_24b(M, eta_korm, lambda_k);
    }
}