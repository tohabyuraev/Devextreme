#include "../core/interp.hpp"
#include "graph.hpp"


float graph_3_35_1(
    const float cy_iz_kr)
{
    map_t data_1_1 = {{0.00000, 2.50779}, {0.00098, 2.65123}, {0.00250, 2.81772}, {0.00500, 2.98851}, {0.00750, 3.07873}, {0.01000, 3.13185}, {0.01250, 3.16184}, {0.01500, 3.16650}, {0.01750, 3.14681}, {0.02000, 3.10856}, {0.02250, 3.05367}, {0.02500, 2.98329}, {0.02750, 2.89791}, {0.03000, 2.79736}, {0.03250, 2.68066}, {0.03500, 2.54552}, {0.03750, 2.38721}, {0.04000, 2.19481}, {0.04250, 1.96878}, {0.04500, 1.70665}, {0.04750, 1.38473}, {0.05000, 0.95771}, {0.05250, 0.33594}, {0.05350, 0.00000}};

    return interp1d(cy_iz_kr, data_1_1);    
}


float graph_3_35_2(
    const float eta_k,
    const float cy_iz_kr)
{
    map_t data_2_1 = {{0.00000, 2.50779}, {0.00109, 2.29614}, {0.00250, 2.11046}, {0.00500, 1.86159}, {0.00750, 1.66205}, {0.01000, 1.49216}, {0.01250, 1.34447}, {0.01500, 1.21613}, {0.01750, 1.10677}, {0.02000, 1.00488}, {0.02250, 0.90517}, {0.02500, 0.80831}, {0.02750, 0.71499}, {0.03000, 0.62584}, {0.03250, 0.54132}, {0.03500, 0.46167}, {0.03750, 0.38689}, {0.04000, 0.31676}, {0.04250, 0.25089}, {0.04500, 0.18884}, {0.04750, 0.13011}, {0.05000, 0.07424}, {0.05250, 0.02079}, {0.05350, 0.00000}};
    map_t data_2_2 = {{0.00000, 2.50779}, {0.00126, 2.45919}, {0.00250, 2.41169}, {0.00500, 2.31560}, {0.00750, 2.21951}, {0.01000, 2.12342}, {0.01250, 2.02733}, {0.01500, 1.93124}, {0.01750, 1.83466}, {0.02000, 1.73238}, {0.02250, 1.62234}, {0.02500, 1.50354}, {0.02750, 1.37487}, {0.03000, 1.24267}, {0.03250, 1.11047}, {0.03500, 0.97827}, {0.03750, 0.84607}, {0.04000, 0.71387}, {0.04250, 0.58168}, {0.04500, 0.44948}, {0.04750, 0.31728}, {0.05000, 0.18508}, {0.05250, 0.05288}, {0.05350, 0.00000}};

    if (1.0 / eta_k < 0.0) {
        return interp1d(cy_iz_kr, data_2_1);
    }
    else if (1.0 / eta_k < 1.0) {
        map_t points = {
            {0.0, interp1d(cy_iz_kr, data_2_1)},
            {1.0, interp1d(cy_iz_kr, data_2_2)},
        };
        return interp1d(1.0 / eta_k, points);
    }
    else {
        return interp1d(cy_iz_kr, data_2_2);
    }
}


float graph_3_35(
    const float M,
    const float eta_k,
    const float cy_iz_kr)
{
    if (M <= 1.1) {
        return graph_3_35_1(cy_iz_kr);
    }
    else if (M < 2.0) {
        map_t points = {
            {1.1, graph_3_35_1(cy_iz_kr)},
            {2.0, graph_3_35_2(eta_k, cy_iz_kr)},
        };
        return interp1d(M, points);
    }
    else {
        return graph_3_35_2(eta_k, cy_iz_kr);
    }
}
