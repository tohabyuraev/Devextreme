#include "../core/interp.hpp"
#include "graph.hpp"


float graph_4_3(
    const float M,
    const float x)
{
    map_t data_1 = {{0.00000, 1.00000}, {0.49399, 0.96952}, {0.69322, 0.95396}, {0.87954, 0.93476}, {1.04726, 0.91363}, {1.20648, 0.89073}, {1.36025, 0.86701}, {1.50002, 0.84586}, {1.64844, 0.82182}, {1.78423, 0.80066}, {1.93787, 0.77837}, {2.11636, 0.75216}, {2.31868, 0.72227}, {2.54054, 0.69141}, {2.74352, 0.66424}, {2.96375, 0.63703}, {3.18995, 0.60945}, {3.41240, 0.58234}, {3.63695, 0.55628}, {3.86864, 0.52933}, {4.14096, 0.50088}, {4.41781, 0.47307}, {4.68827, 0.44893}, {4.97398, 0.42498}, {5.30835, 0.40369}, {5.54674, 0.38999}, {6.00000, 0.36873}};
    map_t data_2 = {{0.00000, 1.00000}, {0.56989, 0.96826}, {0.77123, 0.95103}, {0.96313, 0.92997}, {1.13984, 0.90737}, {1.39912, 0.86821}, {1.65871, 0.83053}, {1.97949, 0.78320}, {2.28613, 0.74058}, {2.59020, 0.69656}, {2.97076, 0.64758}, {3.27033, 0.61106}, {3.66954, 0.56399}, {3.98925, 0.52683}, {4.41781, 0.48561}, {4.80866, 0.45202}, {5.22265, 0.42009}, {5.53122, 0.40266}, {6.00000, 0.37970}};
    map_t data_3 = {{0.00000, 1.00000}, {0.37680, 0.98332}, {0.60011, 0.96952}, {0.82623, 0.95103}, {1.09647, 0.92042}, {1.35517, 0.88566}, {1.63014, 0.84876}, {1.84099, 0.82117}, {2.11636, 0.78103}, {2.37928, 0.74655}, {2.67049, 0.70863}, {2.93984, 0.67530}, {3.34869, 0.62708}, {3.69992, 0.58656}, {4.06326, 0.54991}, {4.43354, 0.51663}, {4.79919, 0.48732}, {5.19184, 0.46151}, {5.52124, 0.44396}, {6.00000, 0.42225}};
    map_t data_4 = {{0.00000, 1.00000}, {0.28623, 0.98993}, {0.52010, 0.97736}, {0.80616, 0.95802}, {1.05880, 0.93169}, {1.30761, 0.90269}, {1.54943, 0.87125}, {1.82116, 0.83821}, {2.09036, 0.80066}, {2.37000, 0.76514}, {2.63977, 0.73175}, {2.95143, 0.69286}, {3.43521, 0.63682}, {3.85944, 0.59209}, {4.37286, 0.54766}, {4.82003, 0.51440}, {5.28674, 0.48732}, {6.00000, 0.46203}};
    map_t data_5 = {{0.00000, 1.00000}, {0.42174, 0.98819}, {0.66653, 0.97535}, {0.92635, 0.95697}, {1.19152, 0.93356}, {1.46830, 0.90737}, {1.70701, 0.87945}, {1.93907, 0.85503}, {2.22964, 0.82182}, {2.48678, 0.79141}, {2.78249, 0.76215}, {3.07370, 0.73136}, {3.41441, 0.69752}, {3.73969, 0.67054}, {4.07075, 0.64535}, {4.51560, 0.61622}, {4.88213, 0.59202}, {5.43477, 0.55886}, {6.00000, 0.53446}};
    map_t data_6 = {{0.00000, 1.00000}, {0.73137, 0.99391}, {1.26364, 0.98627}, {1.68974, 0.97867}, {2.18295, 0.96416}, {2.60841, 0.95030}, {3.16716, 0.92854}, {3.59816, 0.91139}, {4.10915, 0.88809}, {4.57126, 0.86610}, {5.13779, 0.84258}, {5.60545, 0.82653}, {6.00000, 0.81268}};

    if (x < 0.0) {
        return interp1d(M, data_1);
    }
    else if (x < 0.2) {
        map_t points = {
            {0.0, interp1d(M, data_1)},
            {0.2, interp1d(M, data_2)},
        };
        return interp1d(x, points);
    }
    else if (x < 0.5) {
        map_t points = {
            {0.2, interp1d(M, data_2)},
            {0.5, interp1d(M, data_3)},
        };
        return interp1d(x, points);
    }
    else if (x < 0.6) {
        map_t points = {
            {0.5, interp1d(M, data_3)},
            {0.6, interp1d(M, data_4)},
        };
        return interp1d(x, points);
    }
    else if (x < 0.8) {
        map_t points = {
            {0.6, interp1d(M, data_4)},
            {0.8, interp1d(M, data_5)},
        };
        return interp1d(x, points);
    }
    else if (x < 1.0) {
        map_t points = {
            {0.8, interp1d(M, data_5)},
            {1.0, interp1d(M, data_6)},
        };
        return interp1d(x, points);
    }
    else {
        return interp1d(M, data_6);
    };
}