#include "../core/interp.hpp"
#include "graph.hpp"


float graph_4_11(
    const float M,
    const float lambda_n)
{
    map_t data_1 = {{0.6, 0.04654298847374360}, {0.65, 0.05328596155711150}, {0.7, 0.064882698369869}, {0.75,0.0828725380589793}, {0.8,0.106229431787268}, {0.85,0.146635992933952}, {0.9,0.202947253755976}, {0.95,0.264052341405805}, {1.0,0.339482253588312}, {1.05,0.384308589468827}, {1.1,0.402131052409445}, {1.15,0.409370698714754}, {1.2,0.409651389834078}, {1.25,0.405830074779068}, {1.3,0.397906244872941}, {1.4,0.375324509381911}, {1.6,0.331833619037521}, {1.8,0.304302086060512}, {1.9,0.293422441116277}, {2.0,0.282542796172042}, {2.25,0.270173211027595}, {2.5,0.260436237488805}, {3.0,0.248444004305575}, {3.5,0.240925884419543}, {4.0,0.237004109667703}, {4.5,0.23373066788154}, {5.0,0.231508271526003}, {5.5,0.230959063585327} };
    map_t data_2 = {{0.6, 0.02061721278312810}, {0.65, 0.02533184393167990}, {0.7, 0.0322793405404131}, {0.75,0.0414484446896751}, {0.8,0.0540347502356094}, {0.85,0.0753868125077917}, {0.9,0.120721415712525}, {0.95,0.180391598396681}, {1.0,0.242624209773977}, {1.05,0.265934326844439}, {1.1,0.274914606763221}, {1.15,0.274834118277644}, {1.2,0.264719056225948}, {1.25,0.248863312406539}, {1.3,0.236724861399977}, {1.4,0.218608184620221}, {1.6,0.195031697878818}, {1.8,0.18306287267821}, {1.9,0.177858580298365}, {2.0,0.17265428791852}, {2.25,0.166880923285173}, {2.5,0.161107558651827}, {3.0,0.151804549644846}, {3.5,0.144854322216556}, {4.0,0.140330362193892}, {4.5,0.137804534854479}, {5.0,0.13479414896196}, {5.5,0.133334691729357} };
    map_t data_3 = {{0.6, 0.01416011670266370}, {0.65, 0.01584543018287890}, {0.7, 0.0192183254101997}, {0.75,0.0244432874828923}, {0.8,0.0316044868147235}, {0.85,0.0438724426362187}, {0.9,0.0671951935202542}, {0.95,0.106454975845953}, {1.0,0.179886566230827}, {1.05,0.213215597757567}, {1.1,0.215462963140456}, {1.15,0.208992050136839}, {1.2,0.196185246497572}, {1.25,0.183989402271615}, {1.3,0.173746818387569}, {1.4,0.158902431228128}, {1.6,0.142566055092504}, {1.8,0.132656679788779}, {1.9,0.128926136541794}, {2.0,0.124837403977153}, {2.25,0.121162809013537}, {2.5,0.117256372728259}, {3.0,0.108929265474634}, {3.5,0.103360975296673}, {4.0,0.0992740373909637}, {4.5,0.0964643677889499}, {5.0,0.094288063142222}, {5.5,0.0928722761971498} };
    map_t data_4 = {{0.6, 0.00461878746884814}, {0.65, 0.00672558780240638}, {0.7, 0.00922291295105794}, {0.75,0.0127270452186956}, {0.8,0.0174758916443238}, {0.85,0.0248131649342358}, {0.9,0.0385002139096493}, {0.95,0.0678194830575917}, {1.0,0.132855475404552}, {1.05,0.170555037088161}, {1.1,0.168494436578203}, {1.15,0.156930072509768}, {1.2,0.146962244217638}, {1.25,0.138690798274098}, {1.3,0.132325800995084}, {1.4,0.121754612524743}, {1.6,0.109347386365211}, {1.8,0.102340109651399}, {1.9,0.0987603202319974}, {2.0,0.0955442664113815}, {2.25,0.0924692911613526}, {2.5,0.0897580515101096}, {3.0,0.0828717987115143}, {3.5,0.0776925392018327}, {4.0,0.0740607503699851}, {4.5,0.0716780057671865}, {5.0,0.0705007910428068}, {5.5,0.0700582358864996} };
    map_t data_5 = {{0.6, 0.00282591603429604}, {0.65, 0.00363577928391859}, {0.7, 0.00519094366272447}, {0.75,0.00762598255407905}, {0.8,0.0110511127494576}, {0.85,0.0152657640413086}, {0.9,0.0216124748321697}, {0.95,0.0352622258579882}, {1.0,0.0776582267531896}, {1.05,0.0922744514190287}, {1.1,0.0909814567440443}, {1.15,0.0876126730141835}, {1.2,0.0849145472109067}, {1.25,0.0825468883739566}, {1.3,0.0802192568556896}, {1.4,0.0765269578056037}, {1.6,0.0702076853100155}, {1.8,0.0661359073293438}, {1.9,0.0639756272992177}, {2.0,0.0618153472690916}, {2.25,0.0598900673005416}, {2.5,0.0579647873319916}, {3.0,0.0547216804927861}, {3.5,0.0520534450378688}, {4.0,0.0501351985815365}, {4.5,0.0487206439212293}, {5.0,0.0473729007128143}, {5.5,0.0463077959012868} };
    map_t data_6 = {{0.6, 0.00168488664729339}, {0.65, 0.00226170198558744}, {0.7, 0.00319455282638841}, {0.75,0.00427549349126443}, {0.8,0.00624027838172398}, {0.85,0.00834926767183154}, {0.9,0.0114973048368202}, {0.95,0.0168238068891402}, {1.0,0.0389207327849502}, {1.05,0.0571260345957975}, {1.1,0.0586131521003948}, {1.15,0.057666977683269}, {1.2,0.0566839163485837}, {1.25,0.0560080398627141}, {1.3,0.0554682280022116}, {1.4,0.0540369163854724}, {1.6,0.0511262550525758}, {1.8,0.0487137687556259}, {1.9,0.047474770873725}, {2.0,0.0458851906710765}, {2.25,0.0448970858973989}, {2.5,0.0435583988029738}, {3.0,0.0405913096405869}, {3.5,0.0383407982592214}, {4.0,0.0363293705403589}, {4.5,0.035378345957214}, {5.0,0.0346549894456405}, {5.5,0.0339316339712155} };

    if (lambda_n < 1.5) {
        return interp1d(M, data_1);
    }
    else if (lambda_n < 2.0) {
        map_t points = {
            {1.5, interp1d(M, data_1)},
            {2.0, interp1d(M, data_2)},
        };
        return interp1d(lambda_n, points);
    }
    else if (lambda_n < 2.5) {
        map_t points = {
            {2.0, interp1d(M, data_2)},
            {2.5, interp1d(M, data_3)},
        };
        return interp1d(lambda_n, points);
    }
    else if (lambda_n < 3.0) {
        map_t points = {
            {2.5, interp1d(M, data_3)},
            {3.0, interp1d(M, data_4)},
        };
        return interp1d(lambda_n, points);
    }
    else if (lambda_n < 4.0) {
        map_t points = {
            {3.0, interp1d(M, data_4)},
            {4.0, interp1d(M, data_5)},
        };
        return interp1d(lambda_n, points);
    }
    else if (lambda_n < 5.0) {
        map_t points = {
            {4.0, interp1d(M, data_5)},
            {5.0, interp1d(M, data_6)},
        };
        return interp1d(lambda_n, points);
    }
    else {
        return interp1d(M, data_6);
    };
}