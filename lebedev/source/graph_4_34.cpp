#include "../core/interp.hpp"
#include "graph.hpp"


float graph_4_34_1(
    const float c,
    const float c_n)
{
    map_t data_1 = {{0.0, 0.873187494117647}, {0.05, 0.838098363249595}, {0.1,0.786312548987352}, {0.15,0.705389691193309}, {0.2,0.616010241967913}, {0.25,0.55652829677413}, {0.3,0.509881929227426}, {0.35,0.47231438489451}, {0.4,0.441008097950414}, {0.45,0.41377162830905}, {0.5,0.390345583681345}, {0.55,0.369731926120245}, {0.6,0.351009347582304}, {0.65,0.334138436289345}, {0.7,0.319840579065841}, {0.75,0.306909277256463}, {0.8,0.296953877612648}};
    map_t data_2 = {{0.0, 0.822330835294118}, {0.05, 0.807491656866259}, {0.1,0.786312548987352}, {0.15,0.749523849196745}, {0.2,0.691366233054627}, {0.25,0.627579675940681}, {0.3,0.576837404535108}, {0.35,0.535617461696647}, {0.4,0.500397890284038}, {0.45,0.470004704583528}, {0.5,0.444039924057471}, {0.55,0.420265993188234}, {0.6,0.398416815494917}, {0.65,0.380218771037789}, {0.7,0.365836439862448}, {0.75,0.354239983632843}, {0.8,0.34589326428452}};
    map_t data_3 = {{0.0, 0.758485564705882}, {0.05, 0.754709815158160}, {0.1,0.747867273749566}, {0.15,0.733779444624723}, {0.2,0.709882307291762}, {0.25,0.673619193022483}, {0.3,0.628877293042762}, {0.35,0.588961778775139}, {0.4,0.552959550220028}, {0.45,0.522044593091183}, {0.5,0.492434064533175}, {0.55,0.465693278831009}, {0.6,0.440778693128015}, {0.65,0.418342521709613}, {0.7,0.394862807434541}, {0.75,0.377513907442404}, {0.8,0.363598666164333}};
    map_t data_4 = {{0.0, 0.730348605882353}, {0.05, 0.725404316097961}, {0.1,0.717734275796657}, {0.15,0.706456889170758}, {0.2,0.692682467602994}, {0.25,0.677102552716753}, {0.3,0.658099207330577}, {0.35,0.635793478769258}, {0.4,0.611791993065851}, {0.45,0.585181650220769}, {0.5,0.558310421661519}, {0.55,0.529743435960182}, {0.6,0.501176450258844}, {0.65,0.471174593129584}, {0.7,0.44267746632952}, {0.75,0.417347156816139}, {0.8,0.393454196721562}};

    if (c < 0.04) {
        return interp1d(c_n, data_1);
    }
    else if (c < 0.06) {
        map_t points = {
            {0.04, interp1d(c_n, data_1)},
            {0.06, interp1d(c_n, data_2)},
        };
        return interp1d(c, points);
    }
    else if (c < 0.09) {
        map_t points = {
            {0.06, interp1d(c_n, data_2)},
            {0.09, interp1d(c_n, data_3)},
        };
        return interp1d(c, points);
    }
    else if (c < 0.12) {
        map_t points = {
            {0.09, interp1d(c_n, data_3)},
            {0.12, interp1d(c_n, data_4)},
        };
        return interp1d(c, points);
    }
    else {
        return interp1d(c_n, data_4);
    }
}


float graph_4_34_2(
    const float c,
    const float c_n)
{
    map_t data_1 = {{0.0, 0.87404810}, {0.05, 0.833759427952580}, {0.1, 0.750448121998178}, {0.15, 0.664283022298611}, {0.2,0.599019931503765}, {0.25,0.549864710901472}, {0.3,0.507464738778463}, {0.35,0.470783981700956}, {0.4,0.438380863932779}, {0.45,0.411431736283997}, {0.5,0.384910372566148}, {0.55,0.363522176019497}, {0.6,0.342989507334711}, {0.65,0.325647675534065}, {0.7,0.310996760899608}, {0.75,0.298155383777703}, {0.8,0.286845988068543}};
    map_t data_2 = {{0.0, 0.81404944}, {0.05, 0.801668238509255}, {0.1, 0.778568983485225}, {0.15, 0.742023439415337}, {0.2,0.686253943682177}, {0.25,0.632975231789372}, {0.3,0.586028140369473}, {0.35,0.543465629241637}, {0.4,0.505822403319529}, {0.45,0.472242934741286}, {0.5,0.443888716102692}, {0.55,0.419489085345991}, {0.6,0.398292742311043}, {0.65,0.382765326429858}, {0.7,0.369938127858262}, {0.75,0.358850485446728}, {0.8,0.348317225155771}};
    map_t data_3 = {{0.0, 0.76871502}, {0.05, 0.761674735739829}, {0.1, 0.750448121998178}, {0.15, 0.738875510838557}, {0.2,0.715166696186046}, {0.25,0.682371462784345}, {0.3,0.639327718944612}, {0.35,0.598155442228348}, {0.4,0.560458747312805}, {0.45,0.526326751680059}, {0.5,0.495313867919755}, {0.55,0.469024210709152}, {0.6,0.447190427602042}, {0.65,0.42606958435149}, {0.7,0.410563142471339}, {0.75,0.397246936412357}, {0.8,0.388002764278842}};
    map_t data_4 = {{0.0, 0.72863568}, {0.05, 0.723861835783602}, {0.1, 0.716932059551757}, {0.15, 0.707692357909299}, {0.2,0.697528686102593}, {0.25,0.683791747642401}, {0.3,0.667581306435613}, {0.35,0.647192978198807}, {0.4,0.619248033664827}, {0.45,0.584134873996953}, {0.5,0.551302567491662}, {0.55,0.521804680926545}, {0.6,0.494891201341454}, {0.65,0.468868896577061}, {0.7,0.445876586203042}, {0.75,0.430034684225205}, {0.8,0.416549015780362}};

    if (c < 0.04) {
        return interp1d(c_n, data_1);
    }
    else if (c < 0.06) {
        map_t points = {
            {0.04, interp1d(c_n, data_1)},
            {0.06, interp1d(c_n, data_2)},
        };
        return interp1d(c, points);
    }
    else if (c < 0.09) {
        map_t points = {
            {0.06, interp1d(c_n, data_2)},
            {0.09, interp1d(c_n, data_3)},
        };
        return interp1d(c, points);
    }
    else if (c < 0.12) {
        map_t points = {
            {0.09, interp1d(c_n, data_3)},
            {0.12, interp1d(c_n, data_4)},
        };
        return interp1d(c, points);
    }
    else {
        return interp1d(c_n, data_4);
    }
}


float graph_4_34_3(
    const float c,
    const float c_n)
{
    map_t data_1 = {{0.0, 0.895772379310345}, {0.025, 0.871303098075173}, {0.05, 0.812423895026362}, {0.075,0.744674578271496}, {0.1,0.690842164055439}, {0.15,0.608564212782036}, {0.2,0.547543947804176}, {0.25,0.500593518360061}, {0.3,0.464807197545978}, {0.35,0.431314871655875}, {0.4,0.402257602618798}, {0.45,0.374729663531044}, {0.5,0.351330915306452}, {0.55,0.329614430026111}, {0.6,0.309427274695089}, {0.65,0.293552834677899}, {0.7,0.280013760804491}, {0.75,0.267328884456647}, {0.8,0.256391688582726}};
    map_t data_2 = {{0.0, 0.840468041379311}, {0.025, 0.831842619352042}, {0.05, 0.817179725285080}, {0.075,0.796215169526745}, {0.1,0.769146029423785}, {0.15,0.705067104547287}, {0.2,0.641141112665721}, {0.25,0.586544033475005}, {0.3,0.536993743117045}, {0.35,0.495548901490478}, {0.4,0.459150848696668}, {0.45,0.426117321791361}, {0.5,0.400271645647856}, {0.55,0.376872897423265}, {0.6,0.357909206051699}, {0.65,0.33940431366493}, {0.7,0.324111014171732}, {0.75,0.312029307572106}, {0.8,0.301323997926868}};
    map_t data_3 = {{0.0, 0.786199558620690}, {0.05, 0.776428839463169}, {0.1, 0.762457823636279}, {0.15,0.740425866434192}, {0.2,0.713131577146737}, {0.25,0.677447214498548}, {0.3,0.633797592330673}, {0.35,0.584412983308625}, {0.4,0.540338547299701}, {0.45,0.501680487764163}, {0.5,0.465571311274922}, {0.55,0.432011017831983}, {0.6,0.400403824247893}, {0.65,0.369775790118176}, {0.7,0.345966615836538}, {0.75,0.328144033695288}, {0.8,0.314474646668195}};
    map_t data_4 = {{0.0, 0.747525365517241}, {0.05, 0.747789635159998}, {0.1, 0.745729295215420}, {0.15,0.740425866434192}, {0.2,0.731276287296216}, {0.25,0.718868186507357}, {0.3,0.701981836325624}, {0.35,0.678829481988406}, {0.4,0.650366954638065}, {0.45,0.612452319324363}, {0.5,0.564448355285726}, {0.55,0.51984290197549}, {0.6,0.481715859741264}, {0.65,0.447305938616224}, {0.7,0.412896017491184}, {0.75,0.386880424005096}, {0.8,0.367328291816901}};

    if (c < 0.04) {
        return interp1d(c_n, data_1);
    }
    else if (c < 0.06) {
        map_t points = {
            {0.04, interp1d(c_n, data_1)},
            {0.06, interp1d(c_n, data_2)},
        };
        return interp1d(c, points);
    }
    else if (c < 0.09) {
        map_t points = {
            {0.06, interp1d(c_n, data_2)},
            {0.09, interp1d(c_n, data_3)},
        };
        return interp1d(c, points);
    }
    else if (c < 0.12) {
        map_t points = {
            {0.09, interp1d(c_n, data_3)},
            {0.12, interp1d(c_n, data_4)},
        };
        return interp1d(c, points);
    }
    else {
        return interp1d(c_n, data_4);
    }
}


float graph_4_34(
    const float c,
    const float c_n,
    const float x_c)
{
    if (x_c < 0.35) {
        return graph_4_34_1(c, c_n);
    }
    else if (x_c < 0.40) {
        map_t points = {
            {0.35, graph_4_34_1(c, c_n)},
            {0.40, graph_4_34_2(c, c_n)},
        };
        return interp1d(x_c, points);
    }
    else if (x_c < 0.5) {
        map_t points = {
            {0.4, graph_4_34_2(c, c_n)},
            {0.5, graph_4_34_3(c, c_n)},
        };
        return interp1d(x_c, points);
    }
    else {
        return graph_4_34_3(c, c_n);
    }
}
