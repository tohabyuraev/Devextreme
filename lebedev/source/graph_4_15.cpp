#include "../core/interp.hpp"
#include "graph.hpp"


float graph_4_15(
    const float M,
    const float theta)
{
    map_t data_1 = {{0.00000, 0.00000}, {0.62500, 0.62500}, {1.25000, 1.25000}, {2.50000, 2.50000}, {3.75000, 3.75000}, {5.00000, 5.00000}, {6.25000, 6.25000}, {7.50000, 7.50000}, {8.75000, 8.75000}, {9.37500, 9.37500}, {10.00000, 10.00000}};
    map_t data_2 = {{0.00000, 0.00000}, {1.86758, 1.73904}, {2.69765, 2.56208}, {3.19710, 3.07208}, {3.87551, 3.71138}, {4.62004, 4.43059}, {5.26835, 5.03331}, {6.34716, 5.97537}, {7.09676, 6.59834}, {8.66686, 7.83417}, {10.00000, 8.69013}};
    map_t data_3 = {{0.00000, 0.00000}, {1.26934, 1.14311}, {1.96211, 1.75000}, {2.76228, 2.48276}, {4.21399, 3.72703}, {4.79644, 4.19299}, {5.37890, 4.65896}, {6.60966, 5.54024}, {7.77458, 6.21893}, {9.02560, 6.84191}, {10.00000, 7.25723}};
    map_t data_4 = {{0.00000, 0.00000}, {1.27561, 1.09487}, {2.03955, 1.68999}, {3.03142, 2.47926}, {4.01907, 3.21789}, {4.96029, 3.88476}, {6.00280, 4.52208}, {7.12129, 5.09610}, {7.96543, 5.43798}, {8.92775, 5.70810}, {10.00000, 5.90648}};
    map_t data_5 = {{0.00000, 0.00000}, {1.31083, 1.06231}, {2.10094, 1.59715}, {3.01869, 2.21101}, {3.83920, 2.71547}, {4.87243, 3.24424}, {5.97252, 3.70616}, {7.16377, 4.08298}, {8.23954, 4.36256}, {9.18161, 4.49020}, {10.00000, 4.54490}};
    map_t data_6 = {{0.00000, 0.00000}, {1.31083, 0.97439}, {2.03290, 1.43866}, {2.84327, 1.90408}, {3.73807, 2.34612}, {4.63708, 2.70488}, {5.81888, 3.03409}, {6.96775, 3.24836}, {8.08802, 3.37089}, {9.00699, 3.42340}, {10.00000, 3.45841}};

    if (theta < 0.0) {
        return interp1d(M, data_1);
    }
    else if (theta < 5.0) {
        map_t points = {
            {0.0, interp1d(M, data_1)},
            {5.0, interp1d(M, data_2)},
        };
        return interp1d(theta, points);
    }
    else if (theta < 10.0) {
        map_t points = {
            {5.0, interp1d(M, data_2)},
            {10.0, interp1d(M, data_3)},
        };
        return interp1d(theta, points);
    }
    else if (theta < 15.0) {
        map_t points = {
            {10.0, interp1d(M, data_3)},
            {15.0, interp1d(M, data_4)},
        };
        return interp1d(theta, points);
    }
    else if (theta < 20.0) {
        map_t points = {
            {15.0, interp1d(M, data_4)},
            {20.0, interp1d(M, data_5)},
        };
        return interp1d(theta, points);
    }
    else if (theta < 25.0) {
        map_t points = {
            {20.0, interp1d(M, data_5)},
            {25.0, interp1d(M, data_6)},
        };
        return interp1d(theta, points);
    }
    else {
        return interp1d(M, data_6);
    };
}