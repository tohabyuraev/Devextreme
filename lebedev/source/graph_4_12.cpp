#include "../core/interp.hpp"
#include "graph.hpp"


float graph_4_12(
    const float M,
    const float lambda_n)
{
    map_t data_1 = {{0.6f, 0.000416697573645097f}, {0.7f, 0.003616945046607860f}, {0.75f, 0.0060147730917991f}, {0.8f,0.00999072843216862f}, {0.85f,0.0153898523475063f}, {0.9f,0.0241885402953008f}, {0.95f,0.0389440660106554f}, {1.0f,0.0886536816839714f}, {1.05f,0.142231235939023f}, {1.1f,0.168774488326712f}, {1.15f,0.184342114301098f}, {1.2f,0.194739901363244f}, {1.3f,0.206893172959105f}, {1.4f,0.211417994166645f}, {1.5f,0.211587398666586f}, {1.6f,0.209713443945744f}, {1.8f,0.204951341839404f}, {2.0f,0.198806832396044f}, {2.5f,0.189834356264414f}, {3.0f,0.181924319811952f}, {3.5f,0.174182282055616f}, {4.0f,0.168295587367205f}, {4.5f,0.164190732351023f}, {5.0f,0.160605106357345f}, {5.5f,0.157583592226702f} };
    map_t data_2 = {{0.6f, -0.00471479267657601f}, {0.7f, -0.00182618018228176f}, {0.75f, 0.000941431861780032f}, {0.8f,0.00402649555922298f}, {0.85f,0.00915559928581744f}, {0.9f,0.0169851556114768f}, {0.95f,0.0302654165261955f}, {1.0f,0.0689040146352592f}, {1.05f,0.109446416390234f}, {1.1f,0.132135993714667f}, {1.15f,0.143126669474038f}, {1.2f,0.148601569133011f}, {1.3f,0.152790909942986f}, {1.4f,0.153084264157337f}, {1.5f,0.151222101236596f}, {1.6f,0.149367298652558f}, {1.8f,0.145059185158862f}, {2.0f,0.14037155188063f}, {2.5f,0.133937396461535f}, {3.0f,0.127993898804022f}, {3.5f,0.12273140706601f}, {4.0f,0.117768156146749f}, {4.5f,0.114191358376816f}, {5.0f,0.111640976426023f}, {5.5f,0.110001380557799f} };
    map_t data_3 = {{0.6f, -0.01063939251398610f}, {0.7f, -0.00777655438881830f}, {0.75f, -0.00495840354940447f}, {0.8f,-0.00186809249650175f}, {0.85f,0.00282330251750993f}, {0.9f,0.00936569286091841f}, {0.95f,0.0220134629963078f}, {1.0f,0.0495866371826239f}, {1.05f,0.0934450301628719f}, {1.1f,0.104283276142101f}, {1.15f,0.109114000472709f}, {1.2f,0.111311992753679f}, {1.3f,0.11155299746193f}, {1.4f,0.109867230882738f}, {1.5f,0.108351715783422f}, {1.6f,0.106751074931634f}, {1.8f,0.103656565394647f}, {2.0f,0.0997978279223013f}, {2.5f,0.0943071412131451f}, {3.0f,0.0905005648572471f}, {3.5f,0.0870026985310969f}, {4.0f,0.0845002050734193f}, {4.5f,0.0823764516445286f}, {5.0f,0.080998766366021f}, {5.5f,0.0797988479183845f} };
    map_t data_4 = {{0.6f, -0.01747051579124320f}, {0.7f, -0.01544465985394870f}, {0.75f, -0.0137351424620997f}, {0.8f,-0.0109876294362045f}, {0.85f,-0.00698314987104269f}, {0.9f,-0.00074574397586488f}, {0.95f,0.0114546493955723f}, {1.0f,0.0288634584943397f}, {1.05f,0.0576058312355609f}, {1.1f,0.0641535383017428f}, {1.15f,0.0654084821252139f}, {1.2f,0.0652030545020766f}, {1.3f,0.0645834662834524f}, {1.4f,0.0641200126664805f}, {1.5f,0.0632454668676308f}, {1.6f,0.062836586374971f}, {1.8f,0.0610848125075558f}, {2.0f,0.059713296982616f}, {2.5f,0.0571156932290538f}, {3.0f,0.0545595914943301f}, {3.5f,0.0525339224152446f}, {4.0f,0.0504611380805715f}, {4.5f,0.0490405658834267f}, {5.0f,0.047583083303627f}, {5.5f,0.0469025269914012f} };
    map_t data_5 = {{0.6f, -0.02605511662262000f}, {0.7f, -0.02417715820743610f}, {0.75f, -0.0221447509708218f}, {0.8f,-0.0199019108189958f}, {0.85f,-0.0158455456398498f}, {0.9f,-0.0100807780851672f}, {0.95f,-0.000332603890235126f}, {1.0f,0.0136478294164866f}, {1.05f,0.036968013895781f}, {1.1f,0.0418588717671661f}, {1.15f,0.042739572097139f}, {1.2f,0.0426271388088997f}, {1.3f,0.0422332978467943f}, {1.4f,0.0418369012207096f}, {1.5f,0.0414929108730073f}, {1.6f,0.0410819858390553f}, {1.8f,0.0408702321697533f}, {2.0f,0.0397226476498968f}, {2.5f,0.0386220964995403f}, {3.0f,0.0376591976656449f}, {3.5f,0.0364628154195251f}, {4.0f,0.0350097029975994f}, {4.5f,0.0343054372638143f}, {5.0f,0.0331549032482272f}, {5.5f,0.032114545083241f} };

    if (lambda_n < 2.0) {
        return interp1d(M, data_1);
    }
    else if (lambda_n < 2.5) {
        map_t points = {
            {2.0, interp1d(M, data_1)},
            {2.5, interp1d(M, data_2)},
        };
        return interp1d(lambda_n, points);
    }
    else if (lambda_n < 3.0) {
        map_t points = {
            {2.5, interp1d(M, data_2)},
            {3.0, interp1d(M, data_3)},
        };
        return interp1d(lambda_n, points);
    }
    else if (lambda_n < 4.0) {
        map_t points = {
            {3.0, interp1d(M, data_3)},
            {4.0, interp1d(M, data_4)},
        };
        return interp1d(lambda_n, points);
    }
    else if (lambda_n < 5.0) {
        map_t points = {
            {4.0, interp1d(M, data_4)},
            {5.0, interp1d(M, data_5)},
        };
        return interp1d(lambda_n, points);
    }
    else {
        return interp1d(M, data_5);
    };
}