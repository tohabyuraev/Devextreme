#include "../core/interp.hpp"
#include "graph.hpp"


float graph_4_13(
    const float M,
    const float lambda_n)
{
    map_t data_1 = {{0.4, 0.7960037505108520}, {0.45, 0.8049650071735520}, {0.5, 0.818809760163857}, {0.55,0.833546665528236}, {0.6,0.849212890405534}, {0.65,0.866824746144448}, {0.7,0.886866295744476}, {0.75,0.906644810461306}, {0.8,0.933240022936753}, {0.9,0.994116184909501}, {1.0,1.07358372866902}, {1.1,1.14104644216632}, {1.2,1.2019024740792}, {1.3,1.25234940786636}, {1.4,1.30279634165352}, {1.5,1.34055263559236}, {1.6,1.37830892953119}, {1.7,1.40733720106079}, {1.8,1.43636547259038}, {1.9,1.46021770420204}, {2.0,1.4840699358137}, {2.1,1.50290835162175}, {2.2,1.5217467674298}, {2.3,1.53629309353809}, {2.4,1.55083941964639}, {2.5,1.56285818126546}, {2.55,1.56862912694498}, {2.6,1.57369871682579}, {2.65,1.57885403400716}, {2.7,1.58320810490245}, {2.75,1.5877340388808}, {2.8,1.59189796965439}, {2.85,1.59662162911197}, {2.9,1.60012816065558}, {2.95,1.60297969502073}, {3.0,1.60533105972635}, {3.05,1.60775740074335}, {3.1,1.61034595263067}, {3.2,1.61599992666537}, {3.3,1.61921177766819}, {3.4,1.62242362867101}, {3.5,1.62257043907986}, {3.6,1.62261864490741} };
    map_t data_2 = {{0.4, 0.1085386112005450}, {0.45, 0.1302781312878960}, {0.5, 0.156923764957597}, {0.55,0.188907178650093}, {0.6,0.223302221309573}, {0.65,0.260994822882267}, {0.7,0.304035620823102}, {0.75,0.355871431226865}, {0.8,0.415118088893046}, {0.9,0.523622563239595}, {1.0,0.614047765539015}, {1.1,0.689903728448388}, {1.2,0.754263227128148}, {1.3,0.80525456127349}, {1.4,0.856245895418831}, {1.5,0.893269561173357}, {1.6,0.930293226927882}, {1.7,0.954686276240972}, {1.8,0.979079325554063}, {1.9,0.995478898177683}, {2.0,1.0118784708013}, {2.1,1.02496969023291}, {2.2,1.03806090966451}, {2.3,1.04841694564289}, {2.4,1.05877298162127}, {2.5,1.06776945043681}, {2.55,1.07181249050545}, {2.6,1.07585553057409}, {2.65,1.07865521580317}, {2.7,1.08145490103224}, {2.75,1.08425458626132}, {2.8,1.0870542714904}, {2.85,1.08898000512826}, {2.9,1.09090573876612}, {2.95,1.09283147240399}, {3.0,1.09475720604185}, {3.05,1.09611637528779}, {3.1,1.09747554453373}, {3.2,1.10110427170388}, {3.3,1.10274192666545}, {3.4,1.10437958162701}, {3.5,1.10414628863232}, {3.6,1.1039129900512} };
    map_t data_3 = {{0.4, 0.0523634453513426}, {0.45, 0.0468552181752837}, {0.5, 0.0439988094147882}, {0.55,0.0433703679681928}, {0.6,0.0473343345124458}, {0.65,0.0556817799646371}, {0.7,0.069283999259926}, {0.75,0.0892969233904254}, {0.8,0.120692222130151}, {0.9,0.233067911746412}, {1.0,0.342125008353536}, {1.1,0.439362383529236}, {1.2,0.519544302740675}, {1.3,0.574369137067046}, {1.4,0.629193971393416}, {1.5,0.665278510242536}, {1.6,0.701363049091654}, {1.7,0.724542097721557}, {1.8,0.747721146351459}, {1.9,0.762250280839963}, {2.0,0.776779415328467}, {2.1,0.788956302182633}, {2.2,0.8011331890368}, {2.35,0.808948329735353}, {2.5,0.816763470433906}, {2.65,0.821499999154127}, {2.725,0.823635373387239}, {2.8,0.82577074762035}, {2.825,0.827668409796715}, {2.85,0.82956607197308}, {2.875,0.831463734149444}, {2.9,0.833361396325809}, {2.925,0.834920690631477}, {2.95,0.836479984937145}, {2.975,0.838039279242814}, {3.0,0.839598573548482}, {3.05,0.840469639783305}, {3.1,0.841340706018128}, {3.2,0.84354861874177}, {3.3,0.845142008043022}, {3.4,0.846735397344274}, {3.5,0.846935623524853}, {3.6,0.847135853851355} };
    map_t data_4 = {{0.4, 0.0121512675191471}, {0.45, 0.0121370405307862}, {0.5, 0.0121228135424253}, {0.55,0.0124494094688689}, {0.6,0.0135756173780944}, {0.65,0.0173967863851323}, {0.7,0.0232991326525748}, {0.75,0.0323969649969294}, {0.8,0.0428499924509017}, {0.9,0.0860752842252036}, {1.0,0.156937649399516}, {1.1,0.236746584375463}, {1.2,0.296194772061125}, {1.3,0.354442452812204}, {1.4,0.395196931396575}, {1.5,0.426607831958846}, {1.6,0.453363176686627}, {1.7,0.471116005702985}, {1.8,0.488868834719342}, {1.9,0.500021474279006}, {2.0,0.51117411383867}, {2.1,0.517372773784061}, {2.2,0.523571433729452}, {2.3,0.526052513240721}, {2.4,0.529528078311655}, {2.5,0.531155168094174}, {2.55,0.531735822858435}, {2.6,0.532316477622696}, {2.65,0.533228597140966}, {2.7,0.533305098464926}, {2.75,0.533660090750079}, {2.8,0.533810397150929}, {2.85,0.533679514675635}, {2.9,0.533565076719547}, {2.95,0.533239363077651}, {3.0,0.532965515564553}, {3.05,0.532833807813514}, {3.1,0.532422814850187}, {3.2,0.531447470890991}, {3.3,0.52976437143058}, {3.4,0.528909925864836}, {3.5,0.527080541740925}, {3.6,0.525251163648975} };
    map_t data_5 = {{0.4, -0.022302734275600}, {0.45, -0.022779154433028}, {0.5, -0.0232555745904574}, {0.55,-0.023731994747886}, {0.6,-0.0242084149053147}, {0.65,-0.0247328111822126}, {0.7,-0.0252572074591105}, {0.75,-0.0253454105464846}, {0.8,-0.0235084937060864}, {0.9,-0.00293260742145415}, {1.0,0.0454759904305225}, {1.1,0.119176741689487}, {1.2,0.165066008505816}, {1.3,0.192725247630225}, {1.4,0.21009145908814}, {1.5,0.218720301577275}, {1.6,0.227349144066411}, {1.7,0.230954580333129}, {1.8,0.234560016599847}, {1.9,0.236088578658347}, {2.0,0.237617140716846}, {2.1,0.237938847111662}, {2.2,0.238260553506477}, {2.3,0.236981432139126}, {2.4,0.236511232075674}, {2.5,0.236041032012222}, {2.55,0.235269395664382}, {2.6,0.234497759316542}, {2.65,0.233726122968702}, {2.7,0.232954486620861}, {2.75,0.232182850278999}, {2.8,0.231411213937137}, {2.85,0.230639577592286}, {2.9,0.229867941247436}, {2.95,0.229096304902586}, {3.0,0.228324668557735}, {3.05,0.227553032209897}, {3.1,0.226781395862058}, {3.2,0.225718407537408}, {3.3,0.224655419212759}, {3.4,0.223582188579067}, {3.5,0.222522614353447}, {3.6,0.22146304202711} };

    if (lambda_n < 0.0) {
        return interp1d(M, data_1);
    }
    else if (lambda_n < 0.25) {
        map_t points = {
            {0.0, interp1d(M, data_1)},
            {0.25, interp1d(M, data_2)},
        };
        return interp1d(lambda_n, points);
    }
    else if (lambda_n < 0.5) {
        map_t points = {
            {0.25, interp1d(M, data_2)},
            {0.5, interp1d(M, data_3)},
        };
        return interp1d(lambda_n, points);
    }
    else if (lambda_n < 1.0) {
        map_t points = {
            {0.5, interp1d(M, data_3)},
            {1.0, interp1d(M, data_4)},
        };
        return interp1d(lambda_n, points);
    }
    else if (lambda_n < 2.0) {
        map_t points = {
            {1.0, interp1d(M, data_4)},
            {2.0, interp1d(M, data_5)},
        };
        return interp1d(lambda_n, points);
    }
    else {
        return interp1d(M, data_5);
    };
}