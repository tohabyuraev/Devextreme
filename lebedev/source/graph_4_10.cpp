#include "../core/interp.hpp"
#include "graph.hpp"


float graph_4_10(
    const float M,
    const float lambda_n)
{
    map_t data_1 = {{0.00000, 1.00000}, {0.25000, 1.00183}, {0.50000, 1.00557}, {0.75000, 1.01254}, {1.00000, 1.02412}, {1.25000, 1.04169}, {1.50000, 1.06714}, {1.75000, 1.10361}, {2.00000, 1.15568}, {2.25000, 1.23011}, {2.50000, 1.32923}, {2.75000, 1.44842}, {3.00000, 1.57809}, {3.50000, 1.83370}, {4.00000, 2.09544}, {5.00000, 2.72620}, {6.00000, 3.50120}, {7.00000, 4.33876}, {8.00000, 5.23089}, {9.00000, 6.23280}, {10.00000, 7.23590}};
    map_t data_2 = {{0.00000, 1.00000}, {0.25000, 1.00135}, {0.50000, 1.00417}, {0.75000, 1.00943}, {1.00000, 1.01809}, {1.25000, 1.03112}, {1.50000, 1.05004}, {1.75000, 1.07745}, {2.00000, 1.11666}, {2.25000, 1.17132}, {2.50000, 1.24065}, {2.75000, 1.32085}, {3.00000, 1.40686}, {3.50000, 1.58141}, {4.00000, 1.76722}, {5.00000, 2.21584}, {6.00000, 2.74387}, {7.00000, 3.34751}, {8.00000, 3.99352}, {9.00000, 4.68894}, {10.00000, 5.44624}};
    map_t data_3 = {{0.00000, 1.00000}, {0.25000, 1.00097}, {0.50000, 1.00278}, {0.75000, 1.00622}, {1.00000, 1.01206}, {1.25000, 1.02114}, {1.50000, 1.03441}, {1.75000, 1.05290}, {2.00000, 1.07765}, {2.25000, 1.10935}, {2.50000, 1.14721}, {2.75000, 1.19011}, {3.00000, 1.23690}, {3.50000, 1.33861}, {4.00000, 1.44870}, {5.00000, 1.69404}, {6.00000, 1.99763}, {7.00000, 2.32945}, {8.00000, 2.67187}, {9.00000, 3.06547}, {10.00000, 3.46613}};
    map_t data_4 = {{0.00000, 1.00000}, {0.25000, 1.00046}, {0.50000, 1.00139}, {0.75000, 1.00313}, {1.00000, 1.00603}, {1.25000, 1.01043}, {1.50000, 1.01681}, {1.75000, 1.02595}, {2.00000, 1.03864}, {2.25000, 1.05549}, {2.50000, 1.07602}, {2.75000, 1.09945}, {3.00000, 1.12495}, {3.50000, 1.18057}, {4.00000, 1.24533}, {5.00000, 1.40594}, {6.00000, 1.58598}, {7.00000, 1.79955}, {8.00000, 2.01664}, {9.00000, 2.25139}, {10.00000, 2.50026}};
    map_t data_5 = {{0.00000, 1.00000}, {0.25000, 1.00000}, {0.50000, 1.00000}, {0.75000, 1.00000}, {1.00000, 1.00000}, {1.25000, 1.00184}, {1.50000, 1.00549}, {1.75000, 1.01065}, {2.00000, 1.01699}, {2.25000, 1.02429}, {2.50000, 1.03284}, {2.75000, 1.04306}, {3.00000, 1.05538}, {3.50000, 1.08790}, {4.00000, 1.13310}, {5.00000, 1.26027}, {6.00000, 1.40243}, {7.00000, 1.54534}, {8.00000, 1.69170}, {9.00000, 1.85937}, {10.00000, 2.02568}};

    if (lambda_n < 1.5) {
        return interp1d(M, data_1);
    }
    else if (lambda_n < 2.0) {
        map_t points = {
            {1.5, interp1d(M, data_1)},
            {2.0, interp1d(M, data_2)},
        };
        return interp1d(lambda_n, points);
    }
    else if (lambda_n < 3.0) {
        map_t points = {
            {2.0, interp1d(M, data_2)},
            {3.0, interp1d(M, data_3)},
        };
        return interp1d(lambda_n, points);
    }
    else if (lambda_n < 4.0) {
        map_t points = {
            {3.0, interp1d(M, data_3)},
            {4.0, interp1d(M, data_4)},
        };
        return interp1d(lambda_n, points);
    }
    else if (lambda_n < 5.0) {
        map_t points = {
            {4.0, interp1d(M, data_4)},
            {5.0, interp1d(M, data_5)},
        };
        return interp1d(lambda_n, points);
    }
    else {
        return interp1d(M, data_5);
    };
}